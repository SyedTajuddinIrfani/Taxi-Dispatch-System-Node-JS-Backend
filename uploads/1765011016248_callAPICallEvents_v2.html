<html>
<head>
<title>VIP VoIP Call Events API</title>
</head>
<body>
	<h1>Call Events API</h1>
	<p>
		<h2>Get Current Webhooks</h2>
		<pre>curl -X POST --data 'token=XXX&cmd=get' https://voipserverXXXX.vipvoipuk.net/api/extensionStatusv1.php</pre>
		<pre>
[
			{
				"url":"https://your.url",
				"token":"XXX"
			},
			{
				"url":"https://your.other.url",
				"token":"XXX"
			}
]
		</pre>

		<h2>Add A Web Hook</h2>
		<pre>curl -X POST --data 'token=XXX&url=https://some.url&customerToken=12345&cmd=add' https://voipserverXXXX.vipvoipuk.net/api/extensionStatusv1.php</pre>

		<h2>Remove A Web Hook</h2>
		<pre>curl -X POST --data 'token=XXX&url=https://some.url&customerToken=12345&cmd=remove' https://voipserverXXXX.vipvoipuk.net/api/extensionStatusv1.php</pre>
	</p>
	<p>
		<h2>Call Event</h2>
		We will send a HTTP POST request to your URL in the following format:<br />

		<pre>https://www.yourdomain.com/your/voip/code.php</pre>
		<br />
		The body will be JSON in the following format:
		<pre>
{
"token":"1234abc",
"events":[
	{
		"callId":"1546965422.09833",
		"dialledNumber":"441142994032",
		"extension":"200",
		"callerId":"03300881394",
		"status":"Ringing",
		"time":1546965422
	},{
		"callId":"1546965422.09833",
		"dialledNumber":"441142994032",
		"extension":"201",
		"callerId":"03300881394",
		"status":"Ringing",
		"time":1546965422
	}
]
}
		</pre>
		<ul>
			<li>token - A token provided by you that authenticates us and tells you which customer this event is for. E.g b1860783a249a02405f6988c9e83f65a</li>
			<li>events - An array of events in the following format.</li>
			<li>callId - Unique ID of the current call. Will be an empty string if no call is active.</li>
			<li>dialledNumber - The number that was dialled to reach this extension. Will be empty if the call is outgoing.</li>
			<li>extension - This will be the number of the extension that answered the call. E.g 200</li>
			<li>callerId - This will be the number of the person who called. E.g 03300881394. Could be missing if not relevant to event type.</li>
			<li>time - Unix timestamp of when the event was generated. Allows you to discard events if they are out of date.</li>
			<li>status - "Idle", "Ringing" or "In use".</li>
		</ul>
	</p>
</body>
</html>
